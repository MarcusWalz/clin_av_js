{"version":3,"sources":["entry.ts"],"names":["showGraph","showGraph.tick","genGraph"],"mappings":"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AACA;gBAC9B,MAAM,CAAC,YAAY,GAAG,CAAC,CAAC,CAAC,GAAG,GAAG,GAAG,CAAC,CAAC,CAAC,GAAG,GAAG,CAAC;YAAC,CAAC,CAACA,CAACA;QACvDA,CAACA;IAEDD,CAACA;IAED,kBAAkB,CAAC;QACjBE,IAAIA,IAAIA,GAAGA,EAAEA,CAACA;QACdA,CAACA,CAACA,IAAIA,CAACA,MAAMA,CAACA,OAAOA,CAACA,UAACA,CAACA,IAAOA,IAAIA,CAACA,CAACA,CAACA,GAAGA,EAAEA,CAACA,CAACA,CAACA,CAACA,CAACA;QAChDA,CAACA,CAACA,IAAIA,CAACA,OAAOA,CAACA,UAACA,GAAGA;YACjBA,GAAGA,CAACA,CAACA,GAAGA,CAACA,KAAKA,IAAIA,GAAGA,CAACA,CAACA,CAACA;gBACtBA,IAAIA,CAACA,KAAKA,CAACA,CAACA,IAAIA,CAACA,GAAGA,CAACA,KAAKA,CAACA,CAACA,CAACA;YAC/BA,CAACA;QACHA,CAACA,CAACA,CAACA;QAEHA,IAAIA,CAACA,GAAGA,IAAIA,KAAKA,CAACA,KAAKA,CAACA,aAAaA,CAACA,CAACA;QACvCA,GAAGA,CAACA,CAACA,GAAGA,CAACA,KAAKA,IAAIA,IAAIA,CAACA,CAACA,CAACA;YACvBA,CAACA,CAACA,OAAOA,CAACA,IAAIA,UAAUA,CAACA,SAASA,CAACA,KAAKA,EAAEA,IAAIA,CAACA,KAAKA,CAACA,CAACA,CAACA,CAACA;QAC1DA,CAACA;QAEDA,IAAIA,KAAKA,GAAGA,CAACA,CAACA,QAAQA,EAAEA,CAACA;QACzBA,CAACA,CAACA,OAAOA,CAACA,KAAKA,CAACA,CAACA,CAACA,EAAEA,KAAKA,CAACA,CAACA,CAACA,CAACA,CAACA;QAC9BA,CAACA,CAACA,OAAOA,CAACA,KAAKA,CAACA,CAACA,CAACA,EAAEA,KAAKA,CAACA,CAACA,CAACA,CAACA,CAACA;QAC9BA,CAACA,CAACA,OAAOA,CAACA,KAAKA,CAACA,CAACA,CAACA,EAAEA,KAAKA,CAACA,CAACA,CAACA,CAACA,CAACA;QAC9BA,CAACA,CAACA,OAAOA,CAACA,KAAKA,CAACA,CAACA,CAACA,EAAEA,KAAKA,CAACA,CAACA,CAACA,CAACA,CAACA;QAC9BA,CAACA,CAACA,OAAOA,CAACA,KAAKA,CAACA,CAACA,CAACA,EAAEA,KAAKA,CAACA,CAACA,CAACA,CAACA,CAACA;QAE9BA,KAAKA,CAACA,OAAOA,CAACA,UAACA,CAACA,IAAOA,OAAOA,CAACA,GAAGA,CAACA,CAACA,CAACA,SAASA,EAAEA,CAACA,CAACA,CAACA,MAAMA,CAACA,IAAIA,CAACA,CAACA,CAACA,CAACA,CAAAA;QAClEA,OAAOA,CAACA,GAAGA,CAACA,CAACA,CAACA,CAACA;QACfA,OAAOA,CAACA,GAAGA,CAACA,CAACA,CAACA,YAAYA,CAACA,KAAKA,CAACA,CAACA,CAACA,CAACA,CAACA,CAACA;QACtCA,SAASA,CAACA,CAACA,CAACA,CAACA;IAEfA,CAACA;IAED,SAAS,CAAC,KAAK,CAAC,aAAa,EAAE;QAC7B,MAAM,EAAE,IAAI;QACZ,QAAQ,EAAE,IAAI;QACd,MAAM,EAAE,KAAK;QACb,QAAQ,EAAC,UAAC,CAAC,EAAE,GAAG;YACd,EAAE,CAAA,CAAC,GAAG,CAAC,CAAC,CAAC;gBAAC,KAAK,CAAC,GAAG,CAAC,CAAC;YAAC,CAAC;YACvB,IAAI,CAAC,CAAC;gBAAC,QAAQ,CAAC,CAAC,CAAC,CAAC;YAAC,CAAC;QACvB,CAAC;QACD,SAAS,EAAE,GAAG,EAAC,CAChB,CAAC","file":"entry.js","sourcesContent":["/// <reference path=\"../../typings/papaparse/papaparse.d.ts\" />\n/// <reference path=\"../../typings/d3/d3.d.ts\" />\n/// <reference path=\"graph_node.ts\" /> \n/// <reference path=\"graph.ts\" /> \n\nimport papaparse  = require('papaparse');\nimport d3 = require('d3');\nimport graph_node = require('./graph_node');\nimport graph = require('./graph');\n\n\nfunction showGraph(g : graph.Graph ) {\n  var width = 960\n    , height = 700;\n\n  color = d3.scale.category20();\n\n  var links = g.getEdges().map( (edge) => \n      { return { source: edge.fr()\n               , target: edge.to()\n               } } );\n\n  var force = d3.layout.force()\n    .nodes(g.getNodes())\n    .links(links)\n    .charge(-3000)\n    .linkDistance(150)\n    .on('tick', tick)\n    .size([width,height])\n    .start();\n\n  var svg = d3.select('body').append('svg')\n    .attr('width', width)\n    .attr('height', height);\n\n  // build the arrow.\n  svg.append(\"svg:defs\").selectAll(\"marker\")\n      .data([\"end\"])      // Different link/path types can be defined here\n    .enter().append(\"svg:marker\")    // This section adds in the arrows\n      .attr(\"id\", String)\n      .attr(\"viewBox\", \"0 -5 10 10\")\n      .attr(\"refX\", 15)\n      .attr(\"refY\", -1.5)\n      .attr(\"markerWidth\", 6)\n      .attr(\"markerHeight\", 6)\n      .attr(\"orient\", \"auto\")\n  .append(\"svg:path\")\n    .attr(\"d\", \"M0,-5L10,0L0,5\");\n\n  var path = svg.append('svg:g').selectAll(\"path\")\n    .data(force.links())\n    .enter().append('svg:path')\n      .attr('class', 'link');\n\n\n\n  var node = svg.selectAll('.node')\n    .data(force.nodes())\n    .enter().append('g')\n      .attr('class', 'node')\n      .call(force.drag);\n\n   var pie = d3.layout.pie()\n    .sort(null);\n\n   var color = d3.scale.category20();\n\n   var arc = d3.svg.arc()\n    .innerRadius(50)\n    .outerRadius(60);\n\n  node.selectAll(\"path\")\n    .data((d,i) => pie(d.histogram())) \n    .enter()\n      .append('svg:path')\n      .attr('d', arc)\n      .attr('fill', (d,i) => color(i) );\n  node.append('circle')\n    .attr('r', 50);\n\n\n  console.log(node);\n  node.append('text')\n//    .attr('x', '50%') \n//    .attr('y', '50%')\n    .attr('text-anchor', 'middle')\n    .text((n:graph_node.GraphNode) => n.getName()); \n\n\n\n// add the curvy lines\nfunction tick() {\n    path.attr(\"d\", function(d) {\n        var dx = d.target.x - d.source.x,\n            dy = d.target.y - d.source.y,\n            dr = Math.sqrt(dx * dx + dy * dy);\n        return \"M\" + \n            d.source.x + \",\" + \n            d.source.y + \"A\" + \n            dr + \",\" + dr + \" 0 0,1 \" + \n            d.target.x + \",\" + \n            d.target.y;\n    });\n\n    node\n        .attr(\"transform\", function(d) { \n  \t    return \"translate(\" + d.x + \",\" + d.y + \")\"; });\n}\n\n}\n\nfunction genGraph(p) { // parseresult not include in typing\n  var hash = {};\n  p.meta.fields.forEach((f) => { hash[f] = []; });\n  p.data.forEach((row) => {\n    for (var field in row) {\n      hash[field].push(row[field]);\n    }\n  });\n\n  var g = new graph.Graph('hello world');\n  for (var field in hash) { \n    g.addNode(new graph_node.GraphNode(field, hash[field]));\n  }\n\n  var nodes = g.getNodes();\n  g.addEdge(nodes[0], nodes[3]);\n  g.addEdge(nodes[1], nodes[3]);\n  g.addEdge(nodes[2], nodes[3]);\n  g.addEdge(nodes[1], nodes[4]);\n  g.addEdge(nodes[3], nodes[2]);\n\n  nodes.forEach((n) => { console.log(n.histogram()); return true; })\n  console.log(g);\n  console.log(g.calculateCpt(nodes[3]));\n  showGraph(g);\n\n}\n\npapaparse.parse('/sample.tab', {\n  header: true,\n  download: true,\n  worker: false,\n  complete:(p, err) => { \n    if(err) { alert(err); }\n    else { genGraph(p); }  \n  },\n  delimiter: ' '}\n);\n\n\n"],"sourceRoot":"/source/"}