{"version":3,"sources":["todomvc.ts"],"names":["TodoCtrl","TodoCtrl.constructor","TodoCtrl.resetLayout","TodoCtrl.selectNode","TodoCtrl.mouseDown","TodoCtrl.mouseUp","TodoCtrl.rmNode","TodoCtrl.d1","TodoCtrl.d"],"mappings":"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","file":"todomvc.js","sourcesContent":["/// <reference path=\"app.d.ts\" />\n/// <reference path=\"graph_node\" />\n/// <reference path=\"graph\" />\n\n// TODO: Eventually make this the graph modue\n\n\nimport ng = require('angular');\nimport gn = require('graph_node');\nimport d3 = require('d3');\nimport table_reader = require('table_reader');\nimport graph = require('graph');\n\ninterface IGraphScope extends ng.IScope {\n  graph: graph.Graph;\n  selectedNode: gn.GraphNode;\n  vm : TodoCtrl;\n}\n\nexport class TodoCtrl {\n  private force;\n  private graph : graph.Graph;\n  private _mouseDown : gn.GraphNode;\n\n  public width:number = 1000;\n  public height:number = 600;\n  public radius:number = 60;\n\n  public static $inject = [ '$scope', 'tableReaderService' ];\n  constructor( \n        private $scope : IGraphScope,\n        private table_reader : table_reader.TableReaderService ) {\n\n\n    $scope.vm = this;\n\n    table_reader.get('sample.tab')\n      .then( \n        (table) => {\n            var nodes = table;\n\n            var g = this.graph \n                  = this.$scope.graph\n                  = new graph.Graph(\"hello\", table);\n\n            g.addEdge(nodes[0], nodes[1]);\n            g.addEdge(nodes[1], nodes[2]);\n            g.addEdge(nodes[2], nodes[3]);\n            g.addEdge(nodes[3], nodes[4]);\n            g.addEdge(nodes[4], nodes[5]);\n            g.addEdge(nodes[5], nodes[6]);\n            g.addEdge(nodes[6], nodes[0]);\n\n            this.resetLayout();\n\n            console.log(g.getEdges());\n        } , \n        (err) => { \n          alert(err);\n        }\n      );\n  }\n\n  // resets the layout when something has chaged\n  private resetLayout() {\n    this.force = d3.layout.force()\n      .nodes(this.graph.getNodes())\n      .links(this.graph.getEdges())\n      .size([this.width,this.height])\n      .charge(-3000)\n      .linkDistance(this.radius * 2)\n      .on('tick', () => this.$scope.$apply())\n      .start();\n\n  }\n\n  selectNode(node : gn.GraphNode) {\n    if (this.$scope.selectedNode === node) {\n      this.$scope.selectedNode = null;\n    } else if (this.$scope.selectedNode) {\n      this.graph.addEdge(this.$scope.selectedNode, node);\n      this.resetLayout();\n      this.$scope.selectedNode = null;\n    } else {\n      this.$scope.selectedNode = node;\n    }\n  }\n\n  mouseDown(node : gn.GraphNode) {\n    this._mouseDown = node;\n    console.log(\"mousedown\");\n  }\n\n  mouseUp(node : gn.GraphNode) {\n    console.log(\"mouseup\");\n    if (this._mouseDown && this._mouseDown !== node) {\n      this.graph.addEdge(this._mouseDown, node);\n      this.resetLayout();\n    }\n\n    this._mouseDown = null;\n  }\n\n\n  rmNode(node : gn.GraphNode) {\n    this.graph.deleteNode(node);\n    this.$scope.selectedNode = null;\n    this.resetLayout();\n  }\n  d1(e) {\n    var dx = e.target.x - e.source.x;\n    var dy = e.target.y - e.source.y;\n    var dr = Math.sqrt(dx * dx + dy * dy);\n    return 'M' + e.source.x + ',' + e.source.y + 'A' +\n      dr + ',' + dr + ' 0, 0,1 ' + e.target.x + ',' +\n      e.target.y;\n  }\n  d(e) {\n    var dx = (e.target.x - e.source.x);\n    var dy = (e.target.y - e.source.y);\n    var dr = Math.sqrt(dx * dx + dy * dy);\n\n    \n\n    var theta = Math.atan2(dy,dx);\n\n\n    var x1 = Math.cos(theta + Math.PI / 8) * this.radius + e.source.x;\n    var y1 = Math.sin(theta + Math.PI / 8) * this.radius + e.source.y;\n      \n    var x2 = Math.cos(theta) * (dr-this.radius-3) + e.source.x;\n    var y2 = Math.sin(theta) * (dr-this.radius-3) + e.source.y;\n\n    var dr2 = Math.sqrt((x1-x2) * (x1-x2) + (y1-y2) * (y1-y2));\n\n\n    \n    return 'M' + x1 + ',' + y1 + 'A' +\n      dr + ',' + dr + ' 0, 0,1 ' + x2 + ',' +\n      y2;\n\n   // return 'M' + e.target.x + ',' + e.target.y + 'A' + e.source.x + ',' + e.source.y;\n    \n   // return 'M' + 0 + ',' + 0 + 'A' + x2 + ',' + y2;\n  }\n}\n\nvar todomvc = ng.module('todomvc', [])\n  .controller('todoCtrl', TodoCtrl)\n  .service('tableReaderService', table_reader.TableReaderService); \n"],"sourceRoot":"/source/"}